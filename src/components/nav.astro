---

---


<div class="button">
    <input id="checkbox" type="checkbox">
    <label class="toggle" for="checkbox">
        <span id="bar1" class="bars"></span>
        <span id="bar2" class="bars"></span>
        <span id="bar3" class="bars"></span>
    </label>
</div>


<nav>

    <svg class="curved-svg">
        <defs>
            <clipPath id="nav-clip">
                <path class="curve-path" d=""></path>
            </clipPath>
        </defs>
    </svg>

    <pre>Navigation</pre>

    <ul id="nav">
        <li><a href="/">Home</a></li>
        <li><a href="/projects">Projects</a></li>
        <li><a href="/blog">Blog</a></li>
        <li><a href="/contact">Contact</a></li>
    </ul>


    <ul id="links">
        <li><a href="https://github.com/itsmavey">Github</a></li>
    </ul>

</nav>


<style>

    .button {
        position: fixed;

        top: 20px;
        left: 20px;

        z-index: 1000;
    }

    /* From Uiverse.io by vinodjangid07 */
    #checkbox {
        display: none;
    }

    .toggle {
        position: relative;
        width: 30px;
        height: 30px;
        cursor: pointer;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 10px;
        transition-duration: 300ms;
    }

    .bars {
        width: 100%;
        height: 4px;
        background-color: var(--text-main);
        border-radius: 5px;
        transition-duration: 300ms;
    }

    #checkbox:checked + .toggle #bar2 {
        transform: translateY(14px) rotate(60deg);
        margin-left: 0;
        transform-origin: right;
        transition-duration: 300ms;
        z-index: 2;
    }

    #checkbox:checked + .toggle #bar1 {
        transform: translateY(28px) rotate(-60deg);
        transition-duration: 300ms;
        transform-origin: left;
        z-index: 1;
    }

    #checkbox:checked + .toggle {
        transform: rotate(-90deg);
    }

    .curved-svg {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
    }

    .curve-path {
        fill: transparent;
    }

    nav {
        position: fixed;
        height: 100vh;
        width: 100%;

        padding: 10vh 50px;

        isolation: isolate;

        z-index: 999;

        transform: translateX(-100%);

        clip-path: url(#nav-clip);
        -webkit-clip-path: url(#nav-clip);

        backdrop-filter: blur(6px);
        -webkit-backdrop-filter: blur(6px);

        background-color: rgba(17, 24, 39, 0.4);
    }

    #nav {
        display: flex;
        flex-direction: column;
        justify-content: space-evenly;
        align-items: flex-end;

        height: 85%;
        width: 100%;


    }


    nav ul li a {
        position: relative;
        display: inline-block;
        text-align: center;


        background-image: linear-gradient(
                to right,
                var(--primary-green),
                var(--primary-green) 50%,
                var(--text-main) 50%
        );
        background-size: 200% 100%;
        background-position: -100%;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;

        transition: all 500ms ease-in-out;
    }

    nav ul li a:before {
        content: '';
        position: absolute;
        display: block;

        height: 1px;
        width: 0;

        bottom: 15%;
        left: 0;

        background: var(--primary-green);
        transition: all 500ms ease-in-out;
    }

    nav ul li a:hover:before {
        width: 100%;
    }

    nav ul li a:hover {
        background-position: 0;
    }

    #nav a {
        font-size: 1.5rem;
    }

    a {
        font-family: 'Space Mono', monospace;
    }

    @media (min-width: 768px) {
        nav {
            width: 400px;
        }
    }

</style>

<script>
    import {animate, cubicBezier} from "motion";

    class CurvePathAnimator {
        private readonly checkbox: HTMLInputElement | null;
        private readonly curvePath: SVGPathElement | null;
        private readonly navElement: HTMLElement | null;
        private readonly navItems: NodeListOf<HTMLLIElement>;

        private readonly curveWidth: number = 300;
        private readonly initialOffset: number = -125;
        private readonly offsetStep: number = -20;

        constructor() {
            this.checkbox = document.getElementById('checkbox') as HTMLInputElement;
            this.curvePath = document.querySelector('.curve-path') as SVGPathElement;
            this.navElement = document.querySelector('nav');
            this.navItems = document.querySelectorAll('#nav li');

            if (this.checkbox && this.curvePath && this.navElement) {
                this.init();
            }
        }

        private getNavWidth(): number {
            return window.innerWidth >= 768 ? 400 : window.innerWidth;
        }

        private init(): void {
            const isOpened = this.checkbox?.checked ?? false;
            this.renderPath(isOpened ? 1 : 0);
            this.renderNav(isOpened ? 1 : 0);

            this.navItems.forEach((item, index) => {
                const offset = this.initialOffset + (this.offsetStep * index);
                const currentOffset = isOpened ? 0 : offset;
                item.style.transform = `translateX(${currentOffset}px)`;
            });

            this.checkbox?.addEventListener('change', () => this.toggleNav());

            window.removeEventListener('resize', this.handleResize);
            window.addEventListener('resize', this.handleResize);
        }

        private handleResize = (): void => {
            if (this.checkbox) {
                this.renderPath(this.checkbox.checked ? 1 : 0);
            }
        }

        private toggleNav(): void {
            if (!this.checkbox) return;
            const isOpening = this.checkbox.checked;

            const from = isOpening ? 0 : 1;
            const to = isOpening ? 1 : 0;

            animate(from, to, {
                duration: 0.7,
                ease: cubicBezier(0.33, 1, 0.68, 1),
                onUpdate: (latest) => {
                    this.renderNav(latest);
                }
            });

            animate(from, to, {
                duration: 1,
                ease: cubicBezier(0.25, 0.1, 0.25, 1.0),
                onUpdate: (latest) => {
                    this.renderPath(latest);
                }
            });

            this.animateNavItems(isOpening);
        }

        private animateNavItems(isOpening: boolean): void {
            const from = isOpening ? 0 : 1;
            const to = isOpening ? 1 : 0;
            const staggerDelay = 0.1;

            this.navItems.forEach((item, index) => {
                const delay = isOpening ? index * staggerDelay : (this.navItems.length - 1 - index) * staggerDelay;

                animate(from, to, {
                    duration: 1.1,
                    delay: delay,
                    ease: cubicBezier(0.34, 1.56, 0.64, 1),
                    onUpdate: (latest) => {
                        const offset = this.initialOffset + (this.offsetStep * index);
                        const currentOffset = offset * (1 - latest);
                        item.style.transform = `translateX(${currentOffset}px)`;
                    }
                });
            });
        }

        private renderNav(p: number): void {
            if (!this.navElement) return;
            const translateX = (1 - p) * -100;
            this.navElement.style.transform = `translateX(${translateX}%)`;
        }

        private renderPath(p: number): void {
            if (!this.curvePath) return;
            const height = window.innerHeight;
            const targetWidth = this.getNavWidth();
            const initialWidth = 100;
            const width = initialWidth + (targetWidth - initialWidth) * p;
            const curve = this.curveWidth * (1 - p);

            const path = `
                M 0 0
                L ${width} 0
                Q ${width + curve} ${height / 2}, ${width} ${height}
                L 0 ${height}
                Z
            `.trim();

            this.curvePath.setAttribute('d', path);
        }
    }

    function setupNav() {
        new CurvePathAnimator();
    }

    setupNav();
    document.addEventListener('astro:page-load', setupNav);
</script>