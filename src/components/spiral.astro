---
const word = "Software Engineering Student";
const fontSize = "1.5rem";
---

<div class="spiralButton">
    <div class="spiralHoverHitBox">
        <div class="spiral" id="spiral"></div>
        <div class="spiral" id="spiral2"></div>
    </div>
    <pre>Adam Ousmer</pre>
</div>

<style>
    .spiralButton {
        position: relative;
        display: inline-flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;

        cursor: pointer;
        padding: 1em 2em;
        min-height: 80px;

        width: 100%;
        max-width: 100%;
        container-type: inline-size;
    }

    @property --angle {
        syntax: "<angle>";
        initial-value: 0deg;
        inherits: false;
    }

    @keyframes spiral {
        from {
            --angle: 0deg;
        }
        to {
            --angle: 360deg;
        }
    }

    .spiralHoverHitBox {
        position: absolute;
        display: flex;
        align-items: center;
        justify-content: center;
        width: 100%;
        height: 100%;
        padding: 10px;
    }

    .spiral {
        position: absolute;
        display: flex;
        justify-content: center;
        flex-wrap: nowrap;
    }

    :global(.spiral-char) {
        font-size: clamp(0.5rem, 3cqw, 1rem);
        padding: 0.3em;
        user-select: none;
        white-space: nowrap;

        transform: translateY(calc(sin(var(--angle)) * clamp(30px, 10cqw, 60px))) scale(calc(cos(var(--angle)) * -0.5 + 0.55));
        animation: spiral 6000ms steps(360) infinite;

        transition: opacity 500ms ease-in-out,
        color 500ms ease-in-out;
    }

    .spiralButton:hover :global(.spiral-char) {
        opacity: 0.2;
    }

    .spiralButton pre {
        pointer-events: none;

        font-size: clamp(0.875rem, 4cqw, 1.5rem);
        font-weight: 700;

        color: var(--surface-color);
        transition: all 500ms ease-in-out;
        text-align: center;
        margin: 0;
    }

    .spiralButton:hover pre {
        color: var(--text-main);
    }

    @container (max-width: 300px) {
        :global(.spiral-char) {
            padding: 0.2em;
        }
    }
</style>

<script define:vars={{word}}>
    function initSpiral() {
        const spiral1 = document.getElementById("spiral");
        const spiral2 = document.getElementById("spiral2");

        if (spiral1) spiral1.innerHTML = '';
        if (spiral2) spiral2.innerHTML = '';

        const length = word.length;
        const animationDuration = 5000;

        word.split("").forEach((char, i) => {
            function createElement(offset) {
                const div = document.createElement("div");
                div.innerHTML = char === " " ? "&nbsp;" : char;
                div.className = "spiral-char";
                div.style.animationDelay = `-${i * (animationDuration / length) - offset}ms`;
                return div;
            }

            if (spiral1) spiral1.append(createElement(0));
            if (spiral2) spiral2.append(createElement(-1 * (animationDuration / 3)));
        });

        const hitbox = document.querySelector(".spiralHoverHitBox");
        if (hitbox && spiral1) {
            hitbox.style.width = `${spiral1.getBoundingClientRect().width}px`;
        }
    }

    initSpiral();

    document.addEventListener('astro:page-load', initSpiral);
</script>
